
## Time-windowed Intersubject Correlation (ISC) per subject {.unnumbered}


### Description

Computes ISC for each subject by correlating that subject's time series
against the mean of all *other* subjects within sliding windows, then
Fisher z-transforms correlations, averages them per subject, and converts
back to r.



### Usage

<pre><code class='language-R'>time_window_isc(
  data,
  window_size = 10,
  step = 1,
  min_overlap = 3,
  method = c("pearson", "spearman"),
  return_per_window = FALSE
)
</code></pre>


### Arguments

<table role = "presentation">
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="data">data</code></td>
<td>
A numeric matrix or data.frame with rows = time points, columns = participants.
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="window_size">window_size</code></td>
<td>
Integer, window length in time points (default 10).
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="step">step</code></td>
<td>
Integer, step size between consecutive windows (default 1).
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="min_overlap">min_overlap</code></td>
<td>
Integer, minimum number of non-NA paired points within a window
required to compute a correlation (default 3).
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="method">method</code></td>
<td>
Correlation method passed to [stats::cor()], usually &quot;pearson&quot; (default),
or &quot;spearman&quot;.
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="return_per_window">return_per_window</code></td>
<td>
Logical; if TRUE, also return a data.frame of per-window
Fisher-z correlations per subject (default FALSE).
</td></tr>
</table>


### Value

If 'return_per_window = FALSE', a named numeric vector of ISC values (length = n subjects).
If 'TRUE', a list with:
- 'isc': named numeric vector of per-subject ISC (as above)
- 'per_window': data.frame with columns 'window_start', 'window_end', 'subject', 'z'


